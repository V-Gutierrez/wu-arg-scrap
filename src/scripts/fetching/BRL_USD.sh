#!/bin/sh

TARGET=$2
MESSAGE_TITLE="Western Union Companion - By Victor Gutierrez ðŸŸ¢"
TARGET_CURRENCY="USD"

curl 'https://www.westernunion.com/wuconnect/prices/catalog' \
  -H 'authority: www.westernunion.com' \
  -H 'accept: */*' \
  -H 'accept-language: pt-BR,pt;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,es;q=0.5' \
  -H 'cache-control: no-cache' \
  -H 'content-type: text/plain;charset=UTF-8' \
  -H $'cookie: AKZip=; AKAreacode=; AKCounty=; WUCountryCookie_=BR; WULanguageCookie_=en; _evga_e61d=cd97f300195a1d7e.; _gcl_au=1.1.192269537.1671460584; A4kgk7nd=A3Zy0CqFAQAAHFrDWyyHi2-geoWY0CLWbQrqro2avfxhbolVwduPxYBQ7aMcAbUsdyGucgBSwH8AAEB3AAAAAA|1|1|30971075290669f09f7cab3e7720396f4e7076cf; s_ecid=MCMID%7C10527002012958908521997717894336953425; affiliate_src_code=; __qca=P0-1709286564-1671460584261; fp_token_7c6a6574-f011-4c9a-abdd-9894a102ccef=LMgsJRcfyMg7FunMOmfpI6X7duB2Acn9POKakafZbqk=; QuantumMetricUserID=fd6f2bb6039af967626dfd35a3ba712a; lastCountry=AR; lastCurrency=ARS; lastFundsIn=WUPay; userIdentity=existingCustomer; user_txn_state=2:1671629693746; lastFundsOut=BA; __ssid=9609348f42f15f82481811bbadb31bc; AKCountry=BR; AKRegioncode=AM; AKCity=MANAUS; user_session_token=4bf0c904-be6c-4658-b73f-b96e5e44e4eb; abandonedCartToken=8e53e4a3c4cfe6ebafdc44cfad6dd0f9; AK_TLS_Version=tls1.2; resolution_height=600; resolution_width=800; is_tablet=false; is_mobile=false; AK_SID=dGVzdGluZ3Yxed; AKA_A2=A; bm_sz=D7CAF0AF313B67CF7E2D7CD61663A568~YAAQLNXaFz53UoiFAQAAiMphnBIGsYwkHon+56Txmj+Nqo/TeXVaIkoS50ddDbfg0uqCaDXBaAkaGrNLxC7ZepnQMH5vrRVkuMJ8rLScRC1gsrQWaA8MM5dhI0rHQTdOzj2YTuIqW2nYw95HfpySE7Ec8HICZEu507JQNGvzQvAjvldnpbbH1nkXgxLz+/Mv/ZfqnidOreBoXIPqqmpookNa5ap0TQl6/thXSzabAOYbOMvt+DS2xDeg+TIipGdwjArMwLrJksnbJFCy2DEitnOd5vt4ltKlthcuQ/8bY9GRtVtoA4WQT4c=~3420738~4473141; _abck=39232BA13024CCE59B1FDDC26B4FDA09~0~YAAQLNXaF4V3UoiFAQAAzM9hnAmfj6ikYpwZIMjNyIBS0FCEymzr2UFfvWddzhkZkMqy+haz2E3l/0niTMl/8T6HZjoxiOnVZinWymawqh29q4UqL/0rCdKIURWnqG8CXbYhxTeXQCSlyokAJWGGWMxgePiK3uQAusR6wwX+Z/bl0Y6lxNiNSyjjADr3hbRDnq9IRm6v7WhprQLJ523GdCsatFtv7uJ9Qb4xcuZ10cBPLAFhVDkA8UiQ9jObRmk7Gqs3mxpKwQ6p/ToLuV6Ir/Zu93q6r8zGOCx/3Zgdp/ALmApTCH9lhaMHU3mhs5oVf667ughYLTletOW8cVzfh2b5c6aZFLkPvDmMrvbmNgEBEapmHwvktaOO31VMakeQz6NZE0Oib7RGcgMTlD1v2twTVWW+Q7DcaRpvpIggtg==~-1~-1~1673369479; wu_device_id=f3218a8a-3958-bc34-080e-ef65ae8926dd; bm_mi=A31FBD4C407E1261776D18ED2F3FF874~YAAQLNXaF8x3UoiFAQAApNRhnBIn6tq4tPvuXXwlElyu2VaOFm6SOKWFkWr3IWlzsajrfhrxZeOwYRi8QA0NbsLQ+csH1yQYGf8FaIl+r2lGdp9bKeYMt08n4MDAB2IE91oLwCaNHY75vG0IVmg4wqo963HwfFz1ySKHVzh0rqq2kFT4pH5aau2f/0n4TNUG3+tUdB+CHkFf7x4C1mCGtO2JiqwBixEt07wzNmYkdJFvWxU8vssl4ECPVXEmU5bU3EJu/aS10Qw1XLDzmDS6POhcqH0yU/Khzr51pUEz1wKdDWq/XXVYnVei8QmEE7Uah1znucSDa9nvi9rqaeU4Heossvr4V3QHfCuDq4Ck6dxBHJdINPIuF2W1+SVpezXOISM=~1; ak_bmsc=76AE97DF43E62BC68C534D2FD06C2C01~000000000000000000000000000000~YAAQLNXaF+53UoiFAQAA59VhnBLr1gi9iDCmD539yLodWzVxdzHnc7cZZCfkbDMabX0b6Ynw/cKk7SV0Nz9RLpMh9P9AeCADKOp/rI8S7fDZtnwYWh33ImX5+J+Hzr58KdGf9wH8VjR0c0R68lbSH0lAWe/OJHtjcm7Cc3Zv5lMGE+jrQzph2hbPEdrnIBDpU2/AyuyC1+Z/kE28FDE2EX/4OIDB4rne9h1HpK9F1iCwWUDDe+lsF1aXn4NMqST3sfYuashYswkBpVSew3tyIW4LOwA7qJ/CQyk7eEFOCc8WWSqLLjWzWEW8X3jYOa0hIWeXfMo3VD0OeCb8Br2wrns4J38OpqFEG6G4XVpHDoeVhdSgvRamBtjzLXJmxndAG82DbKbdfTsg0cTj41pZNHeM1oWFKOHgKe25y5LpO2XESqcWOlF9ZTmU0sZJJUgHGdKw10Gv2Z+fYtK0/Cn45jkiLL8vokrovmDJ2T3U/hRHSNFkf1hY1fLXPUZh8qoGwgl7aXTbKcxfCEZZGTOhrAGBP3obaDtD50lACfQMiQeeTCckqeedVQ+sojQMqklud7TeK4M=; utm_source=web-bookmark-or-typed; utm_medium=e-web-bookmark-or-typed; utm_campaign=organic-web-bookmark-or-typed; visit-logged-amp=true; AMCVS_AACD3BC75245B4940A490D4D%40AdobeOrg=1; channel_stack=home; s_cc=true; A4kgk7nd_dc=%7B%22c%22%3A%20%22dVNwTkd6SmVXWHhvVzJHUg%3D%3DpzDGISyUvLeVDkhHgMyo-Mvl5QLgjRr3mG5hLtgMv-CcHsqQqGnqCrfaopYW3y06LYCy5m7k4AlP1GO9PHAfp0qIVPbKWfenTeEUfNOG0A%3D%3D%22%2C%20%22dc%22%3A%201%2C%20%22mf%22%3A%201%7D; dtCookie=v_4_srv_3_sn_DA5DBE18D2D57CE2344417A2A139909E_perc_100000_ol_0_mul_1_app-3A4f296d341a47bdba_0; RT="z=1&dm=www.westernunion.com&si=f615b927-54e4-4590-92a5-457baa9d3ec4&ss=lcqevcvi&sl=2&tt=4m2&bcn=%2F%2F17de4c10.akstat.io%2F&ld=bxv"; BIGipServerwudispatcher.westernunion.com=\u0021naCbjg8Vdiy11xg9v++QYZNsXLq+HwwiY/wdursp9PF0xdEfKk+lP3o6SJ1Ra2s9NS7WGjhTdGIyJw==; amplitude_id_7d40b1ccdea38ded011affb5946a3ddd_project-leap-qawesternunion.com=eyJkZXZpY2VJZCI6Ijc0MjYzMzFjLTJiMjctNDRmMi1hMWQxLTc1NGNhNjcxZTU5OFIiLCJ1c2VySWQiOm51bGwsIm9wdE91dCI6ZmFsc2UsInNlc3Npb25JZCI6MTY3MzM2NTkzNjYwOSwibGFzdEV2ZW50VGltZSI6MTY3MzM2NTk0ODQwOCwiZXZlbnRJZCI6MzksImlkZW50aWZ5SWQiOjEwNiwic2VxdWVuY2VOdW1iZXIiOjE0NX0=; amplitude_id_4aec879ef8bf1823486c4338537ec441westernunion.com=eyJkZXZpY2VJZCI6ImM1ODVkMzVmLTJmZTMtOTVhMS04N2MzLTMxMWQ5MTZhNTU1NyIsInVzZXJJZCI6IjMxMzg2NzQ5NmRmNzc3ZWZlNDNjZDM1MjBiMmIzMmYxIiwib3B0T3V0IjpmYWxzZSwic2Vzc2lvbklkIjoxNjczMzY1OTM2NjIxLCJsYXN0RXZlbnRUaW1lIjoxNjczMzY1OTQ4NDE4LCJldmVudElkIjoyMjQsImlkZW50aWZ5SWQiOjE2NCwic2VxdWVuY2VOdW1iZXIiOjM4OH0=; AMCV_AACD3BC75245B4940A490D4D%40AdobeOrg=1585540135%7CMCIDTS%7C19367%7CMCMID%7C10527002012958908521997717894336953425%7CMCAID%7CNONE%7CMCOPTOUT-1673373148s%7CNONE%7CMCAAMLH-1673970748%7C4%7CMCAAMB-1673970748%7Cj8Odv6LonN4r3an7LhD3WZrU1bUpAkFkkiY1ncBR96t2PTI%7CMCSYNCSOP%7C411-19374%7CvVersion%7C4.4.0; s_plt=2.91; s_pltp=br%3Aen%3Awebsite%3Ahome; bm_sv=B189447BC87E5E37791917366D8FBCF8~YAAQLNXaF1+FUoiFAQAA/rtinBJ7moXhecjeBaw8/UWjTv4617yTCbnxKNyKcFxwJdbjY4eBV/+I3SJdFm/CEBWyLsVdw2hzXi7gkbPgctW657GFHAASj45n9n0Na0iC0mdEZjmqEdEmMnOMR75zruXI5UHZx8oDsCMd0wI2Hp5X8Cnh4f/6b9Az1+dz0HLnWhuQ+PvebYlVxcWo0JI1U61bLYHQoehZMNbLXVvR5Fd+Ucw4LXfRhNA/Oy/ztWmY2MEop5norA==~1; _dd_s=logs=1&id=464abc46-63e4-4412-a384-566de3b305a0&created=1673365933491&expire=1673366899997; s_NewRepeateVar=1673366000014-Repeat; s_NewRepeatprop=1673366000017-Repeat' \
  -H 'origin: https://www.westernunion.com' \
  -H 'pragma: no-cache' \
  -H 'referer: https://www.westernunion.com/br/en/home.html' \
  -H 'sec-ch-ua: "Not?A_Brand";v="8", "Chromium";v="108", "Microsoft Edge";v="108"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "Windows"' \
  -H 'sec-fetch-dest: empty' \
  -H 'sec-fetch-mode: cors' \
  -H 'sec-fetch-site: same-origin' \
  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 Edg/108.0.1462.76' \
  -H 'x-nyupe9cs-a: Z1IvAmPDc8AWPrRrdhhGOplI2vESlNK6U-wkbJZryS_ChJ-YUxTt0TqijbudnXQc26zO6F9SCie-s0IugmTJSJ7CkJ5vOERbOksCVJQGmc3YTH71JPn24S4-d=g0So3vpR2hJj8sxESCWM7t3sgJIPAmJUgHH8JiC6Z6Ois60icMvFmL9sZF7hXZ0eigPQvI3Yhez1AzNdQDvYHi1LqmAEZH2eSXsYrjIRQd6Yl4oQjOL=wdBcmAQS1ZVHeZXlKEVgwWr0xRLm48dhSHEK5ZKKEPSrNO6lkZjbTi5BJRsiX84RBDOqutzrLdXwxe0k_abes9bp16og_4xooBY3a65BblYplk=GpRErbC4X3TKuvlROGUwSTGR7XlZNQdtirFrCFDR_n0AO=6pNPe6VTBj0osJh3xmdp7_0Ka2Dk841s9ZtrPKJBCuDj7irc--16xowsPtKrBDzTc_4HwsdE7qlWy7cc0Tyyx1UaNqr52Bytu-ORhJ4BsItCLDpSPBlVJpHkrkSVSduoTH=pGQZ252bIEIJtkkXNyrhnP7svz_2XA1EFonFt46X_Z9cIp_0CTZNgxKALJs7ev0oBmNWgy_wbP8dj-HwkFZR9b2VTSZOYJzcbAHybYyCkkemQygARPTm7A1MVNNzb_0wGZweAMZx9a8bdhBan_yVKQgX4=etTb=VE9PsaFnop7E0c_m52UnHUqGHu31PPNN9isjkeDGkkoNlwshdk_V-=jLlV_HH0Dhq2ZGT63YPcUjwQj0LbHRFp1j3z-pMQ=hZwWH-nHgS6DmIUDY4qSZnoWST1m9xFbFeXKGIO8NsUSHBjeN2F71vdczmZu0Xgckk-t6V-bMi0BsYrmMKkY9HNd2PZiYNZwyaP6V70CawK7j2o3sDRVAP7Zg6LgsqAwEps1eksaTe28Hm3RiE86NpTCN45oaWY_Uu5ohEoY6wOaDEZiduKAbV9c8_VmzRAd9H45Cj-zMqCzBetikDWcy7n6MCtL5IyqdEsBUuCr8X6U6SpX2dFohjtt_Cb0=QD2SIi4qAeBx9_8_UtBm7ZW7AQlbzkc74LVaBnINOCD_RZchgP_SzMhdIczSWVX4Z-nVZdjBu_sDHOon_UarEAmP2X1k9-HSUSzLdr_rXVjAAFwHWeg_N_PvCajDMbmMbQuEWUNimga=ypFh3ik8ylFPDTGnJOOS3_zYuX6aYza_c1s1uEVKG9gZHthy86tE45D-i_bh5TRQDN8_ASEoxnO0e3b0HsgVgaqrwKoeI5J2zAlKMs-Nd3-N08ANAUkQFzP6b7VXCs09kmd8-52T_xcqol8uW7KK0xHnS8EJ22N2McilYmt4b0WBhdZ6_RswM2k1XdvjxxBYc6_SRTuW-4quF2AvSS_M7uYIA3UrWeioZxajpPDF-P4m6EZ-_=ObuiwCDEBCDjiuAdyY9BK1gsAYsGtVc88EYrURn=ms-Z7cqatB4zSu1cx2giZBLGMlcxjx0B-H_UreVpgtr706RBEBoqDv=lvrEmgbM-iTt57WzSEgNgjb_20mpruvHaQGN6vcYyYkuokvEzALLwm8OvTXK6DGLtPkayW5Uy-PKH1FpYqmHFhTZ3qw7FI1eJ4UQq2IRZhc5uQYbmzaUEtYBrP2jZ2TDNNV9IiKzXwd9cN4UGhZ_SmlWLtQixIUE4cYtzbenXXd2tmjhwuldWIY_Q-lzaHI0SIUaC=Za0bEKPpH8y_GcvK13TxxMpWSuVuJX9Og4Aa8UE66ijdzNIhk8dYsTQRqEr=4lwj6NuwAsXXhtOyS0qtX3NV-pCGOsQOVIrv6PSlD3k6MphwcRrxJ2gQuEzDcpQAN=t-=i-jR7Py0nizURBGyImMiBl9NIMejJ3i82vROYeT1NlPnBGSo6Xu4Lv0zpis93B2k26ydGvrHUdrJu6X_mgQOHgzZko8WRAzyxyvDRDIK4mTA3nG4bBjkva5XvU6M9nmla6DzWJuR3WYttxjokBgS9cRTd2yioVOlII3UEDBRCvK7FFW9=v0h9SD0QFJ=ggn-TS_d=oiChyx7xkenT2HN8gIiQ0589FlItWbbJp=zyZMMedLPDhZ4zg2oryuGgNgmQ6O8RCtPlTGihNspEwVCP_QNYdJPtYel_Hk3Th_SZbo1xxIjO=pGC2WYVg8d-ybNbeJSToK1On-aFHHjWb=gU=6UmSheWuK1T6=seuFGXQnuzgdSs7AFgIJrZ4Ui5rWrr1sbo8cDvm3g-QzQ74QH48uTTEpD1HSd4EId92_=ZV9kTsqDbWxXUQpmVOrtyv8nnhRBYpIHKFuWPG4OJbOD4XM9wlYNo3emAyn8=q3duRvpZz7n-7dqlr56HXOlv2tH9wRl_iTEWtNmpt9b5QQOjA24TQ7GIggjL6Wis3kkr9_qBX-rJJqkCKC9YH-2gnG0Nb3SvkDkrHKLAcQmIB3hQYihBb1SM0_EyYTYZ-ZnWzKQcXTnoZO=8ktdOcieNBn8OQJosBVvoiVouBlYxq4SCugYHI4GNhdzN2rnKa8yQqKqcCSI8Yyt5iyDvCUVu_wmhC9j_E=3HXMo46pSE8qP18o71MFhXPsFRi=Bx=Hy5szz519ozI0pVHtL3WQShnXv5bIqkpcKEHgpQiuvXrT7MFvNXTLshyZqF0hEqFmDAAd-azZAcozMoBWdCMqAZbZ4Vh5KdsAnlID6EF_Q3CqzX8h_IoIt_J8GpF=sPHTCOdSbkXLEYZGylrKR0qLMiIU61aeVoEXphh2atA22-bhXelZLCZE1MO8KZN2Zy_ROW1mkjgA1ZC9JXR-5xN_zzwjmWd=9Es_ioGYuAIFUWkojKPS8jBCI4NRqwP-_BdZGDoSzmhOIqAXdY9nJ-l-cD-98KLyy1rN57TBzWKVGKkshAqh-_-IoP-1u8EBmnx0z6HnOavlbU_8FisVrUgOC3tXi1T87jOO53nJBQXmN_VHgyDIu_ObeTSDpY55kNgj6DXiWJquVk3n6eS6dF9RNXEklNhQDVsFDeOi_dSeHBwqUOaIiClATBY9wHFwDFr7FcbD6LKJ6_Rgz5KPj5L1csyVvbN_zA8HJVRb9BeXmuS45t_iP8WkTp_a3S_7gwwZV1OLnT3hhWJulXZ5YVakGbPhl6ijoU_BLFt0=1C=kc485LqL5OVHeYxsi8xm8uDRb2AKe_sc0XZw_JqusB=TaW1xQhPpqQ26baCmCztDv8rRndEXXTgsHgcko8lDemY4NB8PP8Y99K20p2qG=NcN5hnK2FdP_g9WCyurCSEoMIYTCXln7W7_51Xhp-ykCXuBW0PPpqXQurw-YSJvFsyYMZsTgCPZ5vBviDwoIOBv_W3EKB5Td4gWd0R-H4l9Ikiel840rkMBCwP=P5-TNIMGudQK=k9WR_kmqG1Y5WDWvTL7w_rL=ahkJZLJx_7wc__8Zq6DlQ8QZzHEpgPUyt8bvDCl9r=_iQ5eKJTLNYnn5sY8KmmU=Kv55PdQus7Nnrtxg3uKdAQ_EOCLNe3K9M3bvW6H6davBrkrivyuV8rW6XsEk1Yrt_LbQeJbUw_2XK0yOJeUM_3NsCAL7AlVjNR4gFDPQI3JAYAE5kO58=Sz3Z-bKQHts6Hvqhq43zs9Q80XItNj=9GTCFVLbLcu=GOQrpVWF9TMOv-2s0sIEsN4roXP4ojbSUKe59YVwandME0I=WpbS_agw7khEnMzoLU_WqzwaVEtSBUtFJQXTK7PL_6eQor5D7VTF02-cvGWKtPGOrahJjTSrTkHiKrF0q517YxUCbqUaPtQczlg3XyZkKQnJ7XInqJIs8lIVcs_iik4MN57PAmX=BQdgoxCQSdNv-enX3ZQKvOQP-JZhBcLFNyONpYOjySFZtd1ITGZlVKGpdQRw2ZH52FkEqF9IPQ2vg9ghyv3eqT83jmoj_nzWgzAey3KN3Lu55-vuPPSv=CXRiO3E5gS=et7sayKMiNDxrEiGbXZiyZokPqr7P4rh8_8I_3WPLChjYA1BKVBZ84IDJUdjqjoxuQuBlepNuKHidy6mT=9=oorqK=dnToeAN73iOmNDIJzM8FJeMOqHNtibKw-wj9Oz8GECt13KtSCrWFAD24u7h7-G0u-iRAxn2G46ehiZKXtPtkLJde=WxyyErwwVbJ6FlH76O2QLvhFbipn-Fpg2SocqAIWKPNXXS5MdBD3H8m72Z9yeSELjhZhiF_bj5JGYagZzPzOH9ZL-NmnQoNpjNM7ZRMYxiIrbDetwbpxnqETCikEsYEGdkoGhvkpotmYkl-WDyKdv3INYLuAqcdg0Ykrgisi96z34_6QZtAMHg0Ur9tsQc_9mWD5SpoIE76IP0EJl0RKYmOhsVWQumsPA4_BEWTUX8StOeZrV-g4yrHWoSqOVuBmeaaNW0Z7oWHE2yFvOzIZgy77Z1aqdHVCCDXjyM2ogpHPev66ZmhdzPXlinnQTnWXFPEIu4Z-96y0Pe-OUEHz4E1C_ii5VgA7LRIljOQ=8IEUyM6ynikTJhYZBnGC_M1ym=3czol=eNV7DDtvkLeVn_0rq_0F41VSxR2dldtPNd_nKMvLo3on2DHM2n3=xqISllK_=U2aY7CcYBZEbj0NarLsKPBtXWLq6oje9U8NlRp62x4dJ=I7pEMutXY5W3Smuhd2Mi8h9iw0orruUC8vtkvRap2xB-Cop-wnXNMaXymsE1o5AIxuKMo7MWI9zIEgINJHiwnsP-wi9ubnOeC9bFOXjnwRykX8yxSQHalVRg7AJvC-ejhAxYhWVqrmstpnn9MyXGdQNTqTTnZQ3r9V26TPzxxSIrP8sYlKZbAvI9Pc-F83kw2xkAsv34NX-k99Bl-QKKr4Ct716-dtEZ7JY70kMh8zR_FX0quhbKu5gzW6eDraAgEhTTJoWTZWWRiTY=PAkCGbBpoFTW2R81qB5kizSo5GA27kdKwBLTJu8G753wyq_=20niRXXm5wDEYH-Z4g5HaEe5IBj3pU1jwgr3YZEPcBi59FO2aV=mcEuInW78AH6Yk8vtmvP31LHaOrzFhEU0DZ3_TZkry9WlUF=aLjMbLsC4xXyY-OGHWY75r9E5ImEyodeIIWBI5H_LYtdvzSF145UqFNKeWk4JO3v5QIRnSLCrHdCPhNLdgclg5hqkgpbS8I12rXp1OhelzT91N-McGU07d5BHetzpBF4akxjRKbDEZhit4BF21lwI3TcPnicunsC5Bqkl1kmvTImGClpITmXtnp8cAmYi23e-uZmdhnogdYuQnijO0W0-4n0VE14F8yDzwvuOoLgTgHV9milY4bFm2KVhR=P0UV9n0WCBJ-68iDjdcqMEcR548HWbpsiKLt2X0o=zEb81j1Igs3ZKs_6Km9Lpc9mu-xsz20Mm6v6r3gTGFi0d4O0LUpskPZgAsJGu=JoIr5opu=UHcRQPuRx-U=jMuMBamPDcvNY3vmEdu8AuHPFsJY_q-spV7tRYqzZcdDX7JnivBBFGD6cn53N=canxGib66Jcq=MRMHwOpW5r6poaO4sG53wgEQpjK1WrRL0v3Yg7wQ2u16ppEQkAxkxVKxS28L8rDoPOzugh743_ASBksBqjkCGp5MW1RWHIHhRBLKoQqvQhT1WgpzHO_eK7ghSEQj9_0mgOgDn_3v_HA-9T1_VUV3QDSJkHN8i=z0KMyCzFllgrC3_5BznOp2Vn1PeerEUZgkwN35c1NQVv2ULhvPJzbGd-OVy231yt4g5qhv3ykbAvxaSQdsDuVbjozx6hk_Oo5na8tF_JRJMlUMDavr4Go4pRJAFI90m0d=kDMg5rXJ_7AnjHvBlRmSxSZUOq2=Yj36ZCUAzNC8PpEtLX4iJNHi9hCV16MNNkaSMEJ1kQDY4Ag2eQ5C' \
  -H 'x-nyupe9cs-b: -2hfl7w' \
  -H 'x-nyupe9cs-c: AEDEX5yFAQAAJ_PoRSkpRyryQue6uiLyf_mX7uZN4drpayv1_Z3Jb1Qs6Ld8' \
  -H 'x-nyupe9cs-d: ABaChIjBDKGNgUGAQZIQhISi0eIAtJmBDgCdyW9ULOi3fP_____JSxVAALR4d20bMua7xfkW0lAFt8c' \
  -H 'x-nyupe9cs-f: AzH5YZyFAQAAqQv3nD20VAhqfRxQ1T74trH1gOBK6TzIJEeFhGXId_-MF0nrAYp5HuCucgBSwH8AAEB3AAAAAA==' \
  -H 'x-nyupe9cs-z: q' \
  --data-raw '{"header_request":{"version":"0.5","request_type":"PRICECATALOG"},"sender":{"client":"WUCOM","channel":"WWEB","funds_in":"EB","curr_iso3":"BRL","cty_iso2_ext":"BR","send_amount":"100.00"},"receiver":{"curr_iso3":"USD","cty_iso2_ext":"US","cty_iso2":"US"}}' \
  --compressed \
  --progress-bar | grep -o '"fx_rate":[[:digit:]]....' | tr -d 'fx_rate:' | tr -d '"' | {

  read WUCURRENCYVALUE

  if test -z "$WUCURRENCYVALUE"; then
    echo "Current currency ($WUCURRENCYVALUE) value is missing, message was not sent and data procedures were not triggered."
    exit 111
  else
    echo "Sending message to target $TARGET"

    ### Storage
    if [[ ! -e "src/databases/$TARGET_CURRENCY.csv" ]]; then
      touch "src/databases/$TARGET_CURRENCY.csv"
      echo "BASE_BRL;PRICE_$TARGET_CURRENCY;DATE" >>"src/databases/$TARGET_CURRENCY.csv"
    fi

    echo "1 BRL; $WUCURRENCYVALUE; $(date "+%d-%m-%Y %T")" >>"src/databases/$TARGET_CURRENCY.csv"
    ### Storage

    curl "ntfy.sh/$TARGET" \
      -H "X-Title: $MESSAGE_TITLE" \
      -H "X-Priority: 5" \
      -H "Actions: view, Ir para a Western Union, https://www.westernunion.com/br/en/home.html" \
      -d "[$TARGET] 1 BRL = $WUCURRENCYVALUE $TARGET_CURRENCY" \
      --progress-bar

    # Data Analysis
    echo "Sending data to data scripts with $TARGET_CURRENCY parameter"
    python3 -u "src/data_scripts/plot_csv_charts.py" "BRL_$TARGET_CURRENCY" "$TARGET_CURRENCY"
    # Data Analysis
  fi
}

exit 0
