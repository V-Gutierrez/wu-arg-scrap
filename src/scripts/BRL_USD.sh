#!/bin/sh

TARGET=$2
MESSAGE_TITLE="Western Union Companion - By Victor Gutierrez ðŸŸ¢"
TARGET_CURRENCY="USD"

echo "Running Task for pair BRL_$TARGET_CURRENCY"

curl 'https://www.westernunion.com/wuconnect/prices/catalog' \
  -H 'authority: www.westernunion.com' \
  -H 'accept: */*' \
  -H 'accept-language: pt-BR,pt;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,es;q=0.5' \
  -H 'cache-control: no-cache' \
  -H 'content-type: text/plain;charset=UTF-8' \
  -H $'cookie: AKCountry=AR; AKZip=; AKRegioncode=; AKCity=BUENOSAIRES; AKAreacode=; AKCounty=; WUCountryCookie_=BR; WULanguageCookie_=en; _evga_e61d=cd97f300195a1d7e.; _gcl_au=1.1.192269537.1671460584; A4kgk7nd=A3Zy0CqFAQAAHFrDWyyHi2-geoWY0CLWbQrqro2avfxhbolVwduPxYBQ7aMcAbUsdyGucgBSwH8AAEB3AAAAAA|1|1|30971075290669f09f7cab3e7720396f4e7076cf; s_ecid=MCMID%7C10527002012958908521997717894336953425; affiliate_src_code=; __qca=P0-1709286564-1671460584261; AK_TLS_Version=tls1.2; resolution_height=600; resolution_width=800; is_tablet=false; is_mobile=false; AKA_A2=A; bm_sz=71C236167EFB585C94098E0FF0A63A60~YAAQTkostXy9oRaFAQAAOlTkNBI6vv/YVRagNfRcLAm+C4EQIpkgS8E3xctNFIiizJNVWsSD4C8Mvq3a67Uvyk95wpD15G+pWHvgTHq9giaNHirXc/Kexh96WhDbSnMFJEKMfuAn1+GJqeWz94lmOWhHp+7y90I6kh053T6HFDYNqSsHzdjcMeqgYbqMBqukoXUtlzQtM6dcJOkNZ1VzvbCvNq+qcVj2JFZYsgDoAyRg83hprcgFbElg0RxyW2+pCPQRel9P0hUpmnGLvcwj6Povy3hNsziXWgDpIqPCsMCoIFo/8PnxIko=~3163188~3291444; bm_mi=2898944EC4045222F4DFD11C21839909~YAAQTkostZC9oRaFAQAAB1/kNBJR7WVe2rKMQcgsYsskEhWGGc5PnH3LHxMM/+BLjD8tLpZ2oI8UuAb+l8IyGmpz7oOlEHswT4rDMrwfzmc0T1A4oFfdI7F8QKkti8065L68zFfAd/O/Fafy3+mwDo77cfZpTxiG4mq9DzVOsXS7hFZTExuCz89ajFCOZhzrm3ee8/OGmWKcoFhXI27jeFT7wnMmVqe6WcA8e0IK/EJngmdmk5OYO5/2s6S5dD1eCYHta+RGJYTB/AB0+NA7yLkR3UPPbEBrzBuSFGoQdXgjED0QOAaB5lfmcAVnCvIuJOBtnS5eqgTe837lF4hErdXJQNSuMLEK1RbHvX/IGz48E78COGCooF0uQe5nHJmQmg==~1; wu_device_id=41b2ea0a-70d5-7d74-464f-e3ca909e6e76; AMCVS_AACD3BC75245B4940A490D4D%40AdobeOrg=1; AMCV_AACD3BC75245B4940A490D4D%40AdobeOrg=1176715910%7CMCIDTS%7C19348%7CMCMID%7C10527002012958908521997717894336953425%7CMCAID%7CNONE%7CMCOPTOUT-1671636859s%7CNONE%7CMCAAMLH-1672234459%7C4%7CMCAAMB-1672234459%7Cj8Odv6LonN4r3an7LhD3WZrU1bUpAkFkkiY1ncBR96t2PTI%7CMCSYNCSOP%7C411-19353%7CvVersion%7C5.4.0; visit-logged-amp=true; s_cc=true; buildVersion=R22-12.2.1; rxVisitor=1671629668872E1EKKGBQ92M7TIPJR72ER9IJ84G216O9; fp_token_7c6a6574-f011-4c9a-abdd-9894a102ccef=LMgsJRcfyMg7FunMOmfpI6X7duB2Acn9POKakafZbqk=; visit-logged=true; QuantumMetricUserID=fd6f2bb6039af967626dfd35a3ba712a; lastCountry=AR; lastCurrency=ARS; lastFundsIn=WUPay; lastFundsOut=AG; Mn-Tb-dg=0%7e1671629690%7e7a83750; _abck=39232BA13024CCE59B1FDDC26B4FDA09~0~YAAQTkostSW+oRaFAQAABtjkNAkPQQQd5+IApvLcQwSKh5z8ghEcYo64wWCJpDyzQpyZCPZzeWQucZCVOJTwbEt4hVsQaGyXLNylXpdeMTabTXUacNVjiLP1UpNlcZDPFi1/L5YsFu1rE2E6sbBD19G4tSD6bCA07AZX9wm2ARegU9uHB5rYzZ8t6SgIRpbdmulwtefQDF4l8hPCPCe3J6h2CieUGGAQQzcetapUNB/aXl5J32UVsvT63KmIYWbQXdAoyE2y12DPh6F1N7RL6N7EGIvG5tgL/zcfXxzOBfFdgBTAzdWo/AgYuAX6+a90T4qZ647XuehrNb4Bpka9I+pFay/Q2891UPSvmYNDBmr82oAwLm/gpMK3RYczgqewf1a3515xVCtkvyhgK04SNakiDdSRwYx952k60I/h3w==~-1~-1~1671633145; userIdentity=existingCustomer; SMLoginViewToggle=true; ak_bmsc=441BC3F3307373CEEA8B3C57265A9274~000000000000000000000000000000~YAAQTkostTC+oRaFAQAAKePkNBIU/q2S1cwWZDAV16v5WnPHHpCxEN/oc1n/AP7lvhNkVenFUWJGFADwnLSSzQwldX5cwo4sqyHgxTIdvX3WFaoPwvGxIgGlCBCOuwcDzaqdtm+rDd+YOeYMkUPTBFZ0KCdPyTyiBdcD8GTH8WdijScjq1LxLijNs5/rOydHVLZGe7tIklCHeUUrFWDNoigH+2vfA6vrVRa08HZfXBAmsBcLTxQvoHdTfujLjHC1jtE0SE+9mnQ1BbU0JRL4KilTp1ObPLdIBOrtV5ZDTDJzpbrRrHLCnNd2bwL6yqe6heyxBLctDG4Jo0N2Pt8RYOmwYll5W5rVOCsr5QmNlP9A74YuX1zNnb8Hf6iQgQ8/Jb7aYpBLgPYD4Fnyxizt8/VlqcK15Tltc1UcFJ9UU7B4EL8J9oTuiSHN4zMYGXepd6JlbyN1N28BfP43jXQaf7TcfGgc88OHuLP2jYghEe/TJlwrf8Pgw9IYrtR6I7+4/UwMRAjRDojySWCk3WgFqBazeaJNqHT4QbJvdmQQJgALx5QyeVh1BZingLscJRCA8nDTBzs58B8o; SM_Start_Cookie=true; user_txn_state=2:1671629693746; dtLatC=1; rxvt=1671631502747|1671629668874; dtPC=2$29668870_975h-vOCVAHUSPRAPMTORGMHKMMMCFHNQHKHEF-0e0; sc_links=br%3Aen%3Awebsite%3Asend-money%3Areceiverinformation%5E%5Elink-optAddReceiver-cancel; dtSa=true%7CS%7C-1%7C-%7C-%7C1671629741111%7C29668870_975%7Chttps%3A%2F%2Fwww.westernunion.com%2Fbr%2Fen%2Fweb%2Freceiver%7C%7C%7C%7C; utm_source=web-bookmark-or-typed; utm_medium=e-web-bookmark-or-typed; utm_campaign=organic-web-bookmark-or-typed; channel_stack=home|send-money|home; s_sq=%5B%5BB%5D%5D; A4kgk7nd_dc=%7B%22c%22%3A%20%22ZjNLV0w2NE1sQTVWNmZoYg%3D%3D3LNQIb6hHJuv7bXhvUh_J_Tp1lI4nZJMoO5aUGqvC7_Zcb32a7JYjnOX6ZOwShGbcIImHrxIarPoWBuKtRql8eG0TexuPA9UhdtsQv_IwQ%3D%3D%22%2C%20%22dc%22%3A%200%2C%20%22mf%22%3A%200%7D; dtCookie=v_4_srv_1_sn_4FDA41A0E26B81886FD699B8BDBDCE83_perc_100000_ol_0_mul_1_app-3A4f296d341a47bdba_0; RT="z=1&dm=www.westernunion.com&si=f615b927-54e4-4590-92a5-457baa9d3ec4&ss=lbxqfzht&sl=2&tt=3yi&bcn=%2F%2F17de4c1e.akstat.io%2F&ld=3btd"; BIGipServerwudispatcher.westernunion.com=\u00219aJJFi40A2DThfA9v++QYZNsXLq+H3wGP1V7PQq3Jy+0m82S4VCXUyF/wXxyY5g80bS0zZiOMJUCdg==; amplitude_id_7d40b1ccdea38ded011affb5946a3ddd_project-leap-qawesternunion.com=eyJkZXZpY2VJZCI6Ijc0MjYzMzFjLTJiMjctNDRmMi1hMWQxLTc1NGNhNjcxZTU5OFIiLCJ1c2VySWQiOm51bGwsIm9wdE91dCI6ZmFsc2UsInNlc3Npb25JZCI6MTY3MTYzMTg1NDIxMiwibGFzdEV2ZW50VGltZSI6MTY3MTYzMjAwNzM0NywiZXZlbnRJZCI6NSwiaWRlbnRpZnlJZCI6MjgsInNlcXVlbmNlTnVtYmVyIjozM30=; amplitude_id_4aec879ef8bf1823486c4338537ec441westernunion.com=eyJkZXZpY2VJZCI6IjQxYjJlYTBhLTcwZDUtN2Q3NC00NjRmLWUzY2E5MDllNmU3NiIsInVzZXJJZCI6IjMxMzg2NzQ5NmRmNzc3ZWZlNDNjZDM1MjBiMmIzMmYxIiwib3B0T3V0IjpmYWxzZSwic2Vzc2lvbklkIjoxNjcxNjMxODUzNzY2LCJsYXN0RXZlbnRUaW1lIjoxNjcxNjMyMDA3NTM1LCJldmVudElkIjo0OCwiaWRlbnRpZnlJZCI6MjUsInNlcXVlbmNlTnVtYmVyIjo3M30=; s_plt=2.88; s_pltp=br%3Aen%3Awebsite%3Ahome; bm_sv=D501799521BCEE5BF3EF3CAB2502A432~YAAQTkostSDhoRaFAQAApQUJNRKY3sqC09PwpdIN1E8U1ThBSkf/kqkOIiQRVVTnL2a9nLbFMJQOxleQr13NFSGtskcgY5v9foDasnMk0hreKofK4xYjwHvI70MxrUMbmpxZnN8/9urKkh3UUuiYRArsw84xiZyr1+l9WcBJ390IJ4DO3dTbQLj4vS1e8X1bhmMHF2lcEdfO+DojyYDhRJpBRadW3Hb3Jqa9VGSbfMyA6bmN+V/vESo9sIykEh+rKXLsKPz6gw==~1; _dd_s=logs=1&id=e62dc629-3f91-4719-87af-2efd0c9226a5&created=1671631851483&expire=1671632982436; s_NewRepeateVar=1671632082448-Repeat; s_NewRepeatprop=1671632082450-Repeat' \
  -H 'origin: https://www.westernunion.com' \
  -H 'pragma: no-cache' \
  -H 'referer: https://www.westernunion.com/br/en/home.html' \
  -H 'sec-ch-ua: "Not?A_Brand";v="8", "Chromium";v="108", "Microsoft Edge";v="108"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "Windows"' \
  -H 'sec-fetch-dest: empty' \
  -H 'sec-fetch-mode: cors' \
  -H 'sec-fetch-site: same-origin' \
  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 Edg/108.0.1462.54' \
  -H 'x-nyupe9cs-a: rmoaNhfotdzciSINJF6WtsqqZCKP51uLosoCS7B_AEzyTZycIK45mR3T7wVTMsMnCaAhJiLTq09P_h6SeWkhXuPpRoJPHpl_dHQ7SOGSk3ygtOihLdgTjs0uNn4JlaW4=9n=Ny1CU36C8G0D7T5jisql8qf9oeMvcnl-AnFp2gipzFayIS03np_8PU_mB6K26jfxA43LY85EhhPQepxA=JfOd36P5UDizn3BY_idx2XOGCjlz57H1POWcn3PpsD4VKcM7FwHTNFICn87QHdWsZ-l_YDI4fGBNioSLuMBXjOWo9ja_kfuatLx-WhiTsDTRJSQ4CGtdXF7t8GMiIfuehxIru4l7dzdQ5VNvC13nSjm2jY0B_MXstyyt58ZpFzcNvLeRZ6GVrtEFjkXB0cTxW55PImfZcwyQV-zkJdKPaZefnFFQ2NjAJoK2h1CFHyDax6nEaycyoZMXYvoIVwkUvXh4M_lZt2UvSViDP9acX4HPpU4jEVnQwnsrOgdrMm0t5ow-XNFNyNaPkM=h8jFBd9-UC3QOfsCJQDDwnxM6iHitJ1NVxR8WFvSO7ZS5tkZCcBv980FrDd1sGX48Y6t-mY6YNwn3F5UrCfyDBOhBQ4RKjQioLQJPlul4Nc0OWyDMQnR6p=PZjegEyDxPq2KknjVC8=WP9EklvvrAxNAOcoJ1y=Q_iE1BJskD3jk7jSNUmN4sFyJSt5vm1MhOO0=gBVk8lQS=3q7zg7taPPwJMtDcDJUR-Xp9ZnuseCqlWidKLGGBcXGIAp9ngNlRPnhpVMQ998nElsCLkAcY-MGmKXz6aqrTJ7WCxmW_FtJ_e13-n=i=Hj8GFy4gcvdeODSOQnZ1p5ATjuHOv-arcn0utTJwVnhU2Ok7zakU9If3ouE7EkthD9aLmjoH0d9j2c-OpU5_UrF-yj0f4X==KmItsC9R4D7k6rdOvMB6Fs993FoqtZR5gtOVQsj=rE8f79=wESl3DFFSjwJQm50q82_NZAtkfilM_q8kWAz5g48BV-D9tgO_aW7YM4BSKeZ-s01BiT1fnKI-VrN650r6xl9cHfBvQNnuEyPFVprh5Dd0uuBFqhDz7CT3LCa_Tl2-hLT1NGzTHv7sEk8XBctcl_T05xL4ZGMnX8PsqScW=nM4dhss5GWVX9-QuvgN2eO4tTyl5jmVo5cjQxDQKIefVIFaX4jAphG2HdpMNXfHxxo_I0zEdeOWdCWCZMRGHdKzD7KWqls7wGFXyNfaFL09uGdaHiz72QTqLvTUwnvhYHD1DFWZIP9z7pe3ALPUPcrtxF0lS7NZNrd9sepGJXd1ToeLXlHa5R4AjEH769IRsBTXlPI88v_KLFRGnny7K80Zs0nXc4Mv8iUSqr-0tsRQX8DvZ0saVrIHaJC1iWV0Fao3vE-pLZgrN5WnloW5NM6oI2aGJBIt17BmEqeaG4S6STLpodJNsOXfndxeLRjQXZxXsO7O21iB=rizgEXqYwD7rqYE0-au4l_zfKXHEOZPigs8qcd_VHFkkm_FMUSWxW7q6lgcEQHuE0Q=TlQFgXuh0LMty41YLLlSpv9pShJAeDdpJaiVn_uxsrcs_hxI7ozU_AyiCGOz9NwSf5EP331dccLkqgekqVoQIv_Hk=REkoixkHklmxykS71NYmjV9UUqyl-qHZEXfgmOwdc=gNqHPoX6gznm02tvwP8t-fll24ctaQ2mWFNWvRHnrQk97uKzdARN5HG1FdCB=0jBAYnfxkPrSZnV143e7-lz_ocz-XcQeJKSwkuNI_dl6tr8XpzHgdPFxCBzX6T3dC5jnVSGSTT-egcCze9-iAuT1VhLBcWKhx89CWPiJG=m8yXeoisAuXAIPrivRoJkEOB3azzLndHL_sDYFT6IkTOFLdG3TsUZf_Wms3EzsZqjxBY9BhWQ9x4A8_LICywagENmSlxUloRc8BqrgVdIzKk9Odq-liPAxSGAiavM6WCGQj0QJ8LPThCMEfo=3hPUwkpeOajfIGCRjZYaOqrXt4Ka3aDICwwwSgBU4qUxrLJMd679U=7sgdp9utTqUZct79lEziwyRFRI2=rxY3EGJlPxFQV64NMHS9Dmhltyj3aY=RELcOmp2rmiq19u6Km7z0USDtAnzuBLJvacuBO2wqqWWFN9mQENM98vPFeKiyio5HY-nVXpeAciZJhex_Qkm7_NCZpq0w5mIOSILvgrK4aV7xeqwGwESPQ3IqVnkg5GWEAMPzDoLx8-MuBYKU5sM_M-JD9T8dCdYfXFHsMgWfxu2iN4DFKgy7QRy-mnAaOC=Ilmg4oDxC8fehooGscS28WFiDUdm_trodAmnq7RHE1ekS2XJ3IDQIJPzUOX_8oeZF5gIH=8ZdB0lhp4uYXgfIqlBtnOWPS0U1BJftILgf33v3w7i81qkaFnhU7NnOfkGBMWw0iEjlqE2VpSDrAsn99KR4rvFU3hMWrD8y4dWFFiLDetd5zqDW9DY8fRZ9vHda7B9WB7_8-KF-C9jPkDrIYkngq6LQAZVnP7-fjgIkix67g1Rla7aTJQLWRITjK2i9gtX0Z7MFOIjZ33_cDqu_drdSH4DUlAJIh58UYLw-X6x-UH6DUU8uo5hzpOQD0JnulxHJ9WKI_KqHdin3nXrIWJ-5rCPh41VtRncR=nC0rHUetARxiwhl37ROuK-ZNAcZPoBjUE=3x6MGyEYu0urGG20SgportL2USwqFo=91VFKP5f75oapLdYGV4vx7=vhU6l8knmdevmeWqywe-vQxB4jnvAPmYnZ9kIevBWQMB-QTUf6Cg5qnpAW1RhW4=LKSNN=3llWKt4p_aRp9pffVIDSXJ6sYWghCcsWp_AC3qBUpahVSV6iKd=FCmKN_96h4yQt_dkR9KDYI6gTeM=qGT6-R6=2EW0Vn3pujNS-BBX6qjpnDJdYUBLmpNvTQGpmhRel83z=tsjzpfeWK7MEQuu5kIQ=1mAVi6zf_UzW=VDCaHOqNajFf6N74-wW0AUkg4XiYODhMdsj4M52zzj5cPQYw1diqw_20fB_zV4Ix-LcVm3WqPxvKTRasI-SiSZKgTKWu8eGc6vSNoL8qANjO4sdJXtanw2VsMQjVEH7k0PgiUzGQVQ5==BYcpq2RuprsqV7xfYVhhp==ycwaPPMxaKIeLQJvMWc_PPElRQeg3YQija2F4yVZB=ZYrkUUjr-ZIAfAqvsm_IC5OMT3NPN2V=nj1vzh_4_pd9jJfe9zyWniQyYN9PToRoJ3pUQjOPvOnzgCLp8RxtzmuZ_Wf4ogaxq2mEkJBtgLFeIZwm3cnH7BRiqs9l9LlH3xWAJI9-7iehgy0j5xLA0zQE33vem8=SPUrN8MjW9_aqtHaaSLSH0ZiEPmxtD2FTnv8fdFVrKUs5aUspu0uE8yqC9LlnNfocNKw-3iaFH57Tma4vk_cXVSATyBDntC8gL3HwcOo2BEHDjT4vRIovAJ8Nhxh_mhLSjOT7zg2DKZTpElWiXjz5ydkWIAduvKYF-D0f_2E2DYfcpXDYj5BW2BA1hPZMu11nLgt8_q-6=Ezt8oLr_QQ=kIRHcPYMgzr3mXUxcV9F0fweLgwPB6HpvPkTsyoDlEhka=-V75TlXlSsQSAmpHgG5UxuMf=5m_mEyihVJ7rPTayx5U_GMtL8lXX2vI-KkhN3DgHFfF7LyzPU6kEioS794J_kxf8rJKcPvELfpeUr7=y0ahjvMlpd6=Gdjj4cDKiwV73kT1MELoh4sZjXGyuuKm09drQMPQTg0jNq-mMzp8BQ7yfSHT4y01k37eIT1aw2njQGySU91XH1HN4FvpaLzYzPa6sJf2ZPDVWRymrNOXqwJgWrUwq1YHwrvKTg_ASrAoqeUZ9ca9NCzD7SH5m71E=igR2Gy0Cv0xsVa0Zn6hZI6Vz-WBAi9YN0v-mjzcaZdsr_gF7dH9vzWaOhG2VX6PdwBJFf=qFzi4JfR3rxOvCeBJBiDnmlk4S8af1JRSHjRSS8wpPGRDMWXplEqFiD9rSSEvaozFBRB-FNB-_QqyqJtfzBJi=SiRn6QmYnGvMu3dVKWH9fXjdWJ_t55oU3-6uYFkkJh=4vx=KiDVIVQciMli3aMRo8jp5q0QBC5mKK2pf8hilStA7IcLPEDrnVBaSnWnd5KfYFmtXFgvESFj0R=c8PnAYHteJ0cCRw1W_Xg0MKsrzeuQykI-z=kdNk0Z4EvWlO6L3mL8grZEV4-9v7ySwG8EEnJQ9c5E=xySwqK1aRylvVdPusI1UvX7ohxAXvAiFqrl6jOK1unPBVnhuB2JUPlS33SGtgZdxYHijQEyr8tSn6n_Y5QLw1zUQUWRZJEUEWX-KllwffkGN5UQfiMgeLL2UCg9lOL7DpZPXf7uJBgnN645kD=T7Ay3mO7m6hNoB28gRayLcNM7=jTHYd-xgY036nTcFmhY0NPRWXToqEGaRQayOvTjO7eLM_c4ZnxSoK9GuFC1MxX0WfVUQj1I1SaR1wg4VLZiURnR645EWGxH1HgwVrJ9q9nARCehTeuoqVBQ95O=FPHRkBGi81HeskUfjo-feOhiTfX3SC2R_2iZzza3hk7a4y9n8QHuFIfIXVROaYHvDGNgDz_OjL1B4ek-JuX19kkk9wDdFU18lOTozLPPY7UwELIcSOhS8hNhS3stA3mvPAR0=mhPfrr4eo85XKFyqFWBG-6_MDIyHgKF8fh1JIeBXvih6sHEUQypf86gE5Q2le_B647iL1v1VlHURH58LPi5jNdMV0H9qDj4jc8=kPWtSRGz8oSmhKSn90gTI03EZ9urwCYmOaoHYRBvgE-xrN211hw7E--amk-o-VCqARU2EiQmYAkRjIUYZE8hHCCrCuWXrTKTAMuUjcinjr1liQuSglXW4dYvjaxoqHhW6AEZg_Bc1h-VNBw_ymx3_twufM0iamz8FhBNXAQdz5Rm4_BT3QzYLmICGg6O7lTiML6HxhqNjECrecZrMY9O3=_lAyvXHuNEf2GlDKs1JG1cdLu=wv=mlfAnMF2q6yBvScWh-Kdi5HI29AcrrF9kFCMRxyeAS3p81G-uVswfaXBhLVSP4dIhvHrKuTGMYyhvz8gBwm6AzZA8CAM_eZQ8huF2aNVo6Z9egPG_PrTr=r864hISeDo_sQRj0Q=3QKaB0LkDfH2GUW9EKZkBkImSG4zw-k8Wu6NDxDyWiJr2eCW3XEwXmDUSVxF-QwHRFHT_qs8d03Ow_FaD0vIhVPM=JcakGkPcU2GgzTrztAF9_g01tIGzvcL_KzaLmLH_J4H6Vsz44v7t=dOzcomx=NCdc4ojDpSV0kULqFu4s6Ui8eoEs9AGE618N-vGQogim=fDZFtRaz-hLIpCT6vurLc2u0MwcMJl9un-MYvk4wGaM7lJonmr2imJ7rqrweXS8sETWHjLVvF4S4lGXKsu8EJTgk=RSlCvxWavB73mHOnQT2CVKHtOFNvQruM4NcB8IP56BChTNacd9Xl6hfd5=UG4VJxeRD4N-5LZT=jGSilBpQ_pHfro1wizTLmgHag6GGeWyXMlKBTigMyPABSg0_ViZBF0Yuq_INPlLpWfhYxAB3YvBFcTDPZ4gnTx23GvNJtQdV4VFHXr5GERJ=or2HCUaZtUc-DUBzFx6QB3DWnxaIX1niCYXV9j=U5q4Km=D8dT5RQkOSvvAlUXKz6Hwsp4Imkv=g0yCKFy0=NTSBX0N_tun5G50uaW1kuKw8pgzmoD_NFKeNpMEBCnvm_mADi7f_N19N9-Hwm67-WoAyTYY0N7ZYuA1o5FyKJ91NQSuhG4Y5xcBjBy7KKKSSd7-QTzYTk-_DwkWY7V4xfG3fdjt=mjVO887E2SIwDuehmAjwG7sVNrDVI8AFzTh6NHkdWFw5Jkg-C9AODwLV0VCAw47=NH5CTttYeB3qViHDiMipFRzvkINyPJ3SRoZ043OVi97tNPH3Bo5RwZJzSejJ1AFqHZgSxrwcvJEZ5H8uv1mEzFcTyCER58ICOOJTEOjIWDGk4iwHXNaY4gU0hf_tGfX8napfoX' \
  -H 'x-nyupe9cs-b: d4uz9g' \
  -H 'x-nyupe9cs-c: AMAGBTWFAQAASAc9GJiHEKdQ94645H_hm92wPySbjS6QayOafmw1C1X-MvQz' \
  -H 'x-nyupe9cs-d: ABaChIjBDKGNgUGAQZIQhISi0eIAtJmBDgBsNQtV_jL0M______JSxVAAIyiLdoBxQIRBZLAAADNI_Q' \
  -H 'x-nyupe9cs-f: Ax8rCDWFAQAAY67gLcvSapB14PqNo4wYh1YEWx0FfTTLV7VgPcyXGjUrH35YAbUsdyGucgBSwH8AAEB3AAAAAA==' \
  -H 'x-nyupe9cs-z: q' \
  --data-raw '{"header_request":{"version":"0.5","request_type":"PRICECATALOG"},"sender":{"client":"WUCOM","channel":"WWEB","funds_in":"EB","curr_iso3":"BRL","cty_iso2_ext":"BR","send_amount":"100.00"},"receiver":{"curr_iso3":"USD","cty_iso2_ext":"US","cty_iso2":"US"}}' \
  --compressed \
  --progress-bar | grep -o '"fx_rate":[[:digit:]]....' | tr -d 'fx_rate:' | tr -d '"' | {

  read WUCURRENCYVALUE

  if test -z "$WUCURRENCYVALUE"; then
    echo "Current currency ($WUCURRENCYVALUE) value is missing, message was not sent and data procedures were not triggered."
    exit 111
  else
    echo "Sending message to target $TARGET"

    ### Storage
    if [[ ! -e "src/databases/$TARGET_CURRENCY.csv" ]]; then
      touch "src/databases/$TARGET_CURRENCY.csv"
      echo "BASE_BRL;PRICE_$TARGET_CURRENCY;DATE" >>"src/databases/$TARGET_CURRENCY.csv"
    fi

    echo "1 BRL; $WUCURRENCYVALUE; $(date "+%d-%m-%Y %T")" >>"src/databases/$TARGET_CURRENCY.csv"
    ### Storage

    curl "ntfy.sh/$TARGET" \
      -H "X-Title: $MESSAGE_TITLE" \
      -H "X-Priority: 5" \
      -H "Actions: view, Ir para a Western Union, https://www.westernunion.com/br/en/home.html" \
      -d "[$TARGET] 1 BRL = $WUCURRENCYVALUE $TARGET_CURRENCY" \
      --progress-bar

    # Data Analysis
    echo "Sending data to data scripts with $TARGET_CURRENCY parameter"
    python3 -u "src/data_scripts/plot_csv_charts.py" "BRL_$TARGET_CURRENCY" "$TARGET_CURRENCY"
    # Data Analysis
  fi
}

exit 0
